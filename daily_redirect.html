<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Daily Typing Challenge</title>
        <style>
            /* Same CSS as before */
            * {
                box-sizing: border-box;
                margin: 0;
                padding: 0;
            }

            body {
                font-family: Arial, sans-serif;
                background-color: #fff;
                display: flex;
                justify-content: center;
                align-items: center;
                height: 100vh;
                text-align: center;
                color: #333;
            }

            .container {
                background-color: white;
                padding: 20px;
                border-radius: 8px;
                box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
                width: 350px;
            }

            h1 {
                font-size: 28px;
                margin-bottom: 10px;
                color: #333;
            }

            #dailyChallenge {
                font-size: 18px;
                font-weight: bold;
                color: #007bff;
                margin-bottom: 20px;
            }

            #date {
                font-size: 14px;
                color: #888;
                margin-bottom: 20px;
            }

            #inputBox {
                padding: 10px;
                font-size: 18px;
                width: 100%;
                margin-bottom: 20px;
                border: 2px solid #007bff;
                border-radius: 4px;
            }

            #status {
                font-size: 16px;
                color: #555;
            }

            button {
                padding: 10px 20px;
                font-size: 18px;
                cursor: pointer;
                border: none;
                background-color: #28a745;
                color: white;
                border-radius: 4px;
                margin-top: 10px;
                transition: background-color 0.3s;
            }

            button:disabled {
                background-color: #d6d6d6;
            }

            button:hover:not(:disabled) {
                background-color: #218838;
            }

            header {
                width: 100%;
                background-color: #333;
                padding: 10px 0;
                position: fixed;
                top: 0;
                left: 0;
                z-index: 100;
            }

            header a {
                color: white;
                text-decoration: none;
                padding: 15px;
                font-size: 18px;
                margin: 0 15px;
            }

            header a:hover {
                background-color: #444;
                border-radius: 4px;
            }

            .main-content {
                margin-top: 60px;
            }
        </style>
    </head>
    <body>
        <header>
            <a href="alphabetyper.html">Home</a>
            <a href="daily_redirect.html">Daily Challenge</a>
        </header>

        <div class="container main-content">
            <h1>Daily Typing Challenge</h1>
            <div id="dailyChallenge">Loading challenge...</div>
            <div id="date"></div>
            <input type="text" id="inputBox" placeholder="Start typing here..." disabled />
            <p id="status"></p>
            <p>Time: <span id="timer">0.00</span> seconds</p>
            <button id="startButton">Start Challenge</button>
        </div>

        <script>
    // Array of daily challenges (this can be expanded later)
    const dailyChallenges = [
        { date: "01-28-2025", phrase: "Type as fast as you can, every single day!" },
        { date: "01-29-2025", phrase: "Challenge yourself with these typing skills!" },
        { date: "01-30-2025", phrase: "Go eat a croissant, it's the National Holiday!" }
    ];

    const inputBox = document.getElementById("inputBox");
    const timerDisplay = document.getElementById("timer");
    const statusDisplay = document.getElementById("status");
    const startButton = document.getElementById("startButton");
    const dailyChallengeDisplay = document.getElementById("dailyChallenge");
    const dateDisplay = document.getElementById("date");

    let startTime;
    let timerInterval;
    let timeElapsed = 0;
    let typingStarted = false;

    inputBox.disabled = true;

    // Convert UTC to Eastern Time (handles EST/EDT automatically)
    function getEasternDateString() {
        const now = new Date();
        const options = { timeZone: "America/New_York", year: "numeric", month: "2-digit", day: "2-digit" };
        const formatter = new Intl.DateTimeFormat("en-US", options);
        const parts = formatter.formatToParts(now);
        
        const year = parts.find(p => p.type === "year").value;
        const month = parts.find(p => p.type === "month").value;
        const day = parts.find(p => p.type === "day").value;
        
        return `${month}-${day}-${year}`; // MM-DD-YYYY format
    }

    // Update and display today's challenge
    function updateChallenge() {
        const todayEST = getEasternDateString();
        const lastUpdate = localStorage.getItem("lastChallengeDate");

        if (lastUpdate !== todayEST) {
            localStorage.setItem("lastChallengeDate", todayEST);
            const currentChallenge = dailyChallenges.find(challenge => challenge.date === todayEST);

            if (currentChallenge) {
                localStorage.setItem("dailyChallenge", currentChallenge.phrase);
            } else {
                localStorage.setItem("dailyChallenge", "No challenge for today.");
            }
        }

        // Display challenge
        dailyChallengeDisplay.textContent = localStorage.getItem("dailyChallenge");
        dateDisplay.textContent = `Date: ${todayEST}`;
    }

    // Event listeners
    startButton.addEventListener("click", startTest);
    inputBox.addEventListener("input", trackInput);

    function startTest() {
        startButton.disabled = true;
        inputBox.disabled = false;
        inputBox.value = "";
        inputBox.focus();
        statusDisplay.textContent = "";
        timeElapsed = 0;
        typingStarted = false;
        startTime = Date.now();
        timerInterval = setInterval(updateTimer, 10); // Update every 10ms
    }

    function updateTimer() {
        if (typingStarted) {
            const now = Date.now();
            timeElapsed = (now - startTime) / 1000; // Time in seconds (including milliseconds)
            timerDisplay.textContent = timeElapsed.toFixed(2); // Display time to 2 decimal places
        }
    }

    function trackInput() {
        const typedText = inputBox.value;
        const currentChallengeText = localStorage.getItem("dailyChallenge");

        if (typedText === currentChallengeText) {
            clearInterval(timerInterval);
            statusDisplay.textContent = `Test complete! Time: ${timeElapsed.toFixed(2)} seconds.`;
            inputBox.disabled = true;
            startButton.disabled = false;
        } else {
            if (!typingStarted) {
                typingStarted = true;
            }
            if (currentChallengeText.startsWith(typedText)) {
                statusDisplay.textContent = `Keep going...`;
            } else {
                statusDisplay.textContent = `Error! Check your input.`;
            }
        }
    }

    // Initialize the page with today's challenge
    updateChallenge();
</script>

    </body>
</html>
